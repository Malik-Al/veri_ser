# Микросервис для идентификации и верификации клиента в О24

## Требования к серверу
- Сервер с устанвленной ОС Linux. Желательно CentOS 7.
- Установленный docker. [Инструкция по установке](https://docs.docker.com/engine/install/centos/) .
## Запуск
### В режиме разработки
- Должна быть установлена [nodejs](https://nodejs.org/en/download/) для запуска без докера. При разработке использовалась версия v14.5.0 
- ```npm install && npm start```
### Production
- Должна быть запущена база данных MongoDb. Порт базы данных указывается в конфиг файле main.
- ```sh build.sh ```
- ```sh run.sh ```

## Остановка
### Для того чтобы остановить контейнер 
- ```sh stop.sh ```

## Общие сведения


### Микросервис принимает данные заявки (Multipart/formdata) по адресу http://hostname:port/changeOpt24Num.
### Полученные данные проходят проверку по следующим пунктам:
- База данных Optima24 для проверки текущего номера клиента;
- База данных ЕФР для проверки паспортных данных клиента.
- База данных ГРС для проверки паспортных данных клиента.

### При успешном прохождении верификации клиент имееет возможность зарегистрироваться, сменить номер телефона, сбросить пароль
### К созданной заявке прикрепляются фотографии паспорта клиента. Если на этапе прикрепления фотографий возникнет ошибка, приложение удаляет заявку.
### После успешного создания заявки, клиенту отправляется СМС-уведомление на новый номер телефона, указанный в анкете. В случае возникновения ошибки при отправке СМС, приложение попытается переотправить сообщение через три минуты.
### На каждом логическом этапе приложение создает логи (FAIL, SUCCESS, ERROR). Все логи пишутся во Fluentd.